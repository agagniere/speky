kind: tests
category: functional
tests:
- id: TMCP016
  ref: [MCP006]
  short: List tests for requirement
  long: Get all tests that validate a specific requirement
  initial: MCP server is running with tests/samples/simple_requirements.yaml and tests/samples/simple_tests.yaml loaded
  steps:
  - action: Call list_testers_of tool with ID "RF01"
    sample_lang: json
    sample: |
      {
        "jsonrpc": "2.0",
        "method": "tools/call",
        "params": {
          "name": "list_testers_of",
          "arguments": {"id": "RF01"}
        },
        "id": 1
      }
  - action: Verify T01 is returned
    expected: |
      Response contains:
      - {"id": "T01", "category": "functional"}

- id: TMCP017
  ref: [MCP006]
  short: List multiple tests for requirement
  long: Get all tests when a requirement has multiple tests validating it
  initial: MCP server is running with specs/functional.yaml and specs/tests/functional.yaml loaded
  steps:
  - action: Call list_testers_of tool with ID "SF001"
  - action: Verify all tests referencing SF001 are returned sorted by ID
    expected: |
      Response includes TF001 and any other tests with SF001 in their ref field
      Each entry has: id, category
      Optional short field if present

- id: TMCP018
  ref: [MCP006]
  short: List tests for untested requirement
  long: Query tests for a requirement that has no tests
  initial: MCP server is running with a spec containing an untested requirement
  steps:
  - action: Add a requirement without tests
    run: cat requirements.yaml
    sample_lang: yaml
    sample: |
      kind: requirements
      category: functional
      requirements:
      - id: RF99
        long: An untested requirement
  - action: Start MCP server and call list_testers_of with ID "RF99"
  - action: Verify empty list is returned
    expected: Response is an empty array []

- id: TMCP019
  ref: [MCP006]
  short: List tests for non-existent requirement
  long: Query tests for a requirement ID that does not exist
  initial: MCP server is running with tests/samples/simple_requirements.yaml loaded
  steps:
  - action: Call list_testers_of tool with ID "INVALID"
    sample_lang: json
    sample: |
      {
        "jsonrpc": "2.0",
        "method": "tools/call",
        "params": {
          "name": "list_testers_of",
          "arguments": {"id": "INVALID"}
        },
        "id": 1
      }
  - action: Verify error response
    expected: |
      JSON-RPC error response with message indicating that requirement "INVALID" does not exist
